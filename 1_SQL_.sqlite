 SELECT *
 FROM quiz
 LIMIT 3;
 
 SELECT *
 FROM home_try_on
 LIMIT 3;
 
 SELECT *
 FROM purchase
 LIMIT 3;

SELECT DISTINCT q.user_id, 
 h.user_id IS NOT NULL AS 'is_home_try_on',
 h.number_of_pairs,
 p.product_id IS NOT NULL AS 'is_purchase'
 FROM quiz AS 'q'
 LEFT JOIN home_try_on AS 'h'
 ON q.user_id = h.user_id
 LEFT JOIN purchase AS 'p'
 ON q.user_id = p.user_id
 LIMIT 10;

WITH form AS (SELECT DISTINCT q.user_id, 
 h.user_id IS NOT NULL AS 'is_home_try_on',
 h.number_of_pairs,
 p.product_id IS NOT NULL AS 'is_purchase'
 FROM quiz AS 'q'
 LEFT JOIN home_try_on AS 'h'
 ON q.user_id = h.user_id
 LEFT JOIN purchase AS 'p'
 ON q.user_id = p.user_id
 LIMIT 10)
 
 SELECT SUM (is_home_try_on = 1), SUM (number_of_pairs IS NOT NULL), SUM (is_purchase = 1)
FROM form;
 